<!DOCTYPE HTML>
<html lang="en">
  <head>
    <title>WebGL Globe</title>
    <meta charset="utf-8">
    <link href='http://fonts.googleapis.com/css?family=Josefin+Slab:400,700' rel='stylesheet' type='text/css'>   
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="/globe/style.css">
  </head>
  <body>
    <div id="container"></div>
  <div id="top"></div>
  <div id='head'>
    <h2 id="logo" href='#'>TwitDashBoard</h2>
    <h4 class='menu' id="static">3D RECORDED</h4>
    <h4 class="menu" id="dynamic"><a href="/../">2D REAL-TIME</a></h4>               
  </div>
      
  <div id="graph">
    <div id="graphhead">
      <div id="graphtext">Tweets per minute</div>
      <div id="graphBtn">X</div>
    </div>
    <div id="holder"></div>
  </div>
  <div id="title">
    Tweets recorded in a 15min interval
  </div>

  

  <script type="text/javascript" src="third-party/Three/ThreeWebGL.js"></script>
  <script type="text/javascript" src="third-party/Three/ThreeExtras.js"></script>
  <script type="text/javascript" src="third-party/Three/RequestAnimationFrame.js"></script>
  <script type="text/javascript" src="third-party/Three/Detector.js"></script>
  <script type="text/javascript" src="third-party/Tween.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="globe.js"></script> 
  <script type="text/javascript" src="/../js/raphael.js"></script>
  <script type="text/javascript" src="/../js/popup.js"></script>
  <script type="text/javascript" src="/../js/graph.js"></script>
  <script type="text/javascript">
  var data;
  jQuery(function ($) {

    $( document ).ready(function() {

      $.get( "/../getlatlong", success, "json" );
      drawGridRfl();
      drawGraph();

      $("#graphBtn").click(function(){
        console.log('Btn click');
        $("#graph").toggle("fast");
        $(this).toggleClass("active");
        return false;
      });
    });

    function success( dat ) {
      data = dat;  
      console.log("length " + data[0][1].length);
      drawGlobe();
    }

    function drawGlobe(){
      if(!Detector.webgl){
        Detector.addGetWebGLMessage();
      } 

      else {
        var container = document.getElementById('container');
        var globe = new DAT.Globe(container); 
        function loadGlobe(){
          for (var i=0;i<data.length;i++) {
            globe.addData(data[i][1], {format: 'magnitude', name: data[i][0], animated: true});
          }
          globe.createPoints();              
          globe.animate();
        }
        loadGlobe();
      }
    }    
  });

  </script>

  </body>

</html>
